# ğŸŸ íŒ”íŒ”ì‡ì¸  - ì•„ì§ íŒ”íŒ”í•˜ì¡°?
### íŒ”íŒ”í•œ ìƒíƒœë¡œ ë°œë¹ ë¥¸ ë°°ì†¡, íŒ”íŒ”ì‡ì¸ !
<img width="300px" alt="íŒ”íŒ”ì‡ì¸  ì•„ì´ì½˜" src="https://github.com/palpalTeam/Palpal-Eats/assets/82515938/16cd8b2f-0a8c-4e6b-9992-0513ed3c8fe0">

## ğŸŸ Demo Video
[![Video Label](http://img.youtube.com/vi/rNcWXk7oPFM/0.jpg)](https://youtu.be/rNcWXk7oPFM)

## ğŸŸ Links
- [Github](https://github.com/palpalTeam/Palpal-Eats)
- [Notion](https://www.notion.so/8abced91c2a8471daa12612c1754d7b2?pvs=4)
- [Figma](https://www.figma.com/file/zxAYZYaTPT70jWjvP8MZnV?embed_host=notion&kind=file&mode=design&node-id=0-1&t=kovpGCl0YpQyM5Nu-0&type=design&viewer=1)
- [ERD Cloud](https://www.erdcloud.com/d/XZALdEPNeiLpMnZAk)
- [Postman](https://universal-comet-344748.postman.co/workspace/Team-Workspace~c43626f4-d8a8-4e3f-8689-03585237ebc7/collection/31674523-d80de786-5160-4f5d-9677-b58e70e79f1b?action=share&creator=31348504)

## ğŸŸ Personal Role
| Name | Role                                |
|------|-------------------------------------|
| [ì¡°ì›í˜¸](https://github.com/wonowonow) | Auth API, User API, MyInfo API      |
| [ì´ì§€ì„ ](https://github.com/jiisuniui) | Cart API, Order API, BackOffice API |
| [ê¹€ì¢…ê·œ](https://github.com/Kim-Jong-Gyu) | S3 API, Store API, Menu API         |
| [ê¹€ëŒ€ì˜](https://github.com/kdy9960) | Review API                          |

## ğŸŸ Commit Convention
| Tag Name | Description |
|---|---|
| Feat | ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì¶”ê°€ |
| Fix | ë²„ê·¸ ìˆ˜ì • |
| Design | CSS ë“± ì‚¬ìš©ì UI ë””ìì¸ ë³€ê²½ |
| !BREAKING CHANGE | ì»¤ë‹¤ë€ API ë³€ê²½ |
| !HOTFIX | ê¸‰í•˜ê²Œ ì¹˜ëª…ì ì¸ ë²„ê·¸ë¥¼ ê³ ì³ì•¼í•˜ëŠ” ê²½ìš° |
| Style | ì½”ë“œ í¬ë§· ë³€ê²½, ì„¸ë¯¸ ì½œë¡  ëˆ„ë½, ì½”ë“œ ìˆ˜ì •ì´ ì—†ëŠ” ê²½ìš° |
| Refactor | í”„ë¡œë•ì…˜ ì½”ë“œ ë¦¬íŒ©í† ë§ |
| Comment | í•„ìš”í•œ ì£¼ì„ ì¶”ê°€ ë° ë³€ê²½ |
| Test | í…ŒìŠ¤íŠ¸ ì½”ë“œ, ë¦¬í™í† ë§ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì¶”ê°€, Production Code(ì‹¤ì œë¡œ ì‚¬ìš©í•˜ëŠ” ì½”ë“œ) ë³€ê²½ ì—†ìŒ |
| Chore | ë¹Œë“œ ì—…ë¬´ ìˆ˜ì •, íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ìˆ˜ì •, íŒ¨í‚¤ì§€ ê´€ë¦¬ì êµ¬ì„± ë“± ì—…ë°ì´íŠ¸, Production Code ë³€ê²½ ì—†ìŒ |
| Rename | íŒŒì¼ í˜¹ì€ í´ë”ëª…ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ì˜®ê¸°ëŠ” ì‘ì—…ë§Œì¸ ê²½ìš° |
| Remove | íŒŒì¼ì„ ì‚­ì œí•˜ëŠ” ì‘ì—…ë§Œ ìˆ˜í–‰í•œ ê²½ìš° |

## ğŸŸ UI/UX
<img width="779" alt="image" src="https://github.com/palpalTeam/Palpal-Eats/assets/82515938/05484013-f64e-411b-80ad-551569dc924a">

## ğŸŸ ERD
![image](https://github.com/palpalTeam/Palpal-Eats/assets/82515938/d9df1ab7-c57b-4b22-96cb-d8c2617988b2)

## ğŸŸ API ëª…ì„¸ì„œ
### 0. API ì„¤ê³„ ê¸°ì¤€
- UI/UX ê¸°ì¤€ìœ¼ë¡œ API êµ¬ì¡° ì„¤ê³„
- ì™€ì´ì–´ í”„ë ˆì„ì„ ì°¸ê³ ë¡œ ìˆœì°¨ì ìœ¼ë¡œ ì‘ë™í•˜ë„ë¡ ì„¤ê³„ í•¨

### 1. User API
| Name | Method | URL | Auth |
|---|---|---|---|
| íšŒì›ê°€ì… | POST | /users/signup | none |
| ë¡œê·¸ì¸ | POST | /users/login | none |
| ë¡œê·¸ì•„ì›ƒ | PATCH | /users/logout | user |

### 2. MyInfo API
| Name | Method | URL | Auth |
|---|---|---|---|
| ì£¼ì†Œ ë³€ê²½ | PATCH | /myinfo/address | user |
| ë‹‰ë„¤ì„ ë³€ê²½ | PATCH | /myinfo/nickname | user |
| ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ | PATCH | /myinfo/password | user |
| ë‚´ ì •ë³´ ì¡°íšŒ | GET | /myinfo | user |
| ë‚´ ì£¼ë¬¸ ë‚´ì—­ ë‹¨ì¼ ì¡°íšŒ | GET | /myinfo/orders/{orderId} | user |
| ë‚´ ì£¼ë¬¸ ë‚´ì—­ ì „ì²´ ì¡°íšŒ | GET | /myinfo/orders | user |

### 3. BackOffice API
| Name | Method | URL | Auth |
|---|---|---|---|
| ê°€ê²Œì˜ ì£¼ë¬¸ ë‚´ì—­ ë‹¨ì¼ ì¡°íšŒ | GET | /backoffice/stores/{storeId}/orders/{orderId} | seller |
| ê°€ê²Œì˜ ì£¼ë¬¸ ë‚´ì—­ ì „ì²´ ì¡°íšŒ | GET | /backoffice/stores/{storeId}/orders | seller |

### 4. Store API
| Name | Method | URL | Auth |
|---|---|---|---|
| ê°€ê²Œ ìƒì„± | POST | /stores | seller |
| ê°€ê²Œ ìˆ˜ì • - ì´ë¦„ | PATCH | /stores/{storeId}/name | seller |
| ê°€ê²Œ ìˆ˜ì • - ì¹´í…Œê³ ë¦¬ | PATCH | /stores/{storeId}/category | seller |
| ê°€ê²Œ ìˆ˜ì • - ì£¼ì†Œ | PATCH | /stores/{storeId}/address | seller |
| ê°€ê²Œ ìˆ˜ì • - ì „í™”ë²ˆí˜¸ | PATCH | /stores/{storeId}/phone | seller |
| ê°€ê²Œ ìˆ˜ì • - ì†Œê°œê¸€ | PATCH | /stores/{storeId}/content | seller |
| ê°€ê²Œ ìˆ˜ì • - ìµœì†Œì£¼ë¬¸ê¸ˆì•¡ | PATCH | /stores/{storeId}/min_delivery_price | seller |
| ê°€ê²Œ ìˆ˜ì • - ì‚¬ì§„ | PATCH | /stores/{storeId}/picture | seller |
| ê°€ê²Œ ì‚­ì œ | PATCH | /stores/{storesId}/delete | seller |
| ìœ ì € ì†Œìœ ì˜ ê°€ê²Œ ì „ì²´ ì¡°íšŒ | GET | /stores/user | seller |
| ê°€ê²Œ ì „ì²´ ì¡°íšŒ | GET | /stores/total | none |
| ê°€ê²Œ ë‹¨ì¼ ì¡°íšŒ | GET | /stores/{storeId} | none |

### 5. Menu API
| Name | Method | URL | Auth |
|---|---|---|---|
| ë©”ë‰´ ìƒì„± | POST | /stores/{storeId}/menu | seller |
| ë©”ë‰´ ìˆ˜ì • - ì´ë¦„ | PATCH | /stores/{storeId}/menu/name | seller |
| ë©”ë‰´ ìˆ˜ì • - ê°€ê²© | PATCH | /stores/{storeId}/menu/price | seller |
| ë©”ë‰´ ìˆ˜ì • - ì¹´í…Œê³ ë¦¬ | PATCH | /stores/{storeId}/menu/category | seller |
| ë©”ë‰´ ìˆ˜ì • - ì‚¬ì§„ | PATCH | /stores/{storeId}/menu/picture | seller |
| ë©”ë‰´ ì‚­ì œ | PATCH | /stores/{storeId}/menu/{menuId}/delete | seller |
| í•´ë‹¹ ê°€ê²Œì˜ ë©”ë‰´ ì „ì²´ ì¡°íšŒ | GET | /stores/{storeId}/menu | none |
| í•´ë‹¹ ê°€ê²Œì˜ ë©”ë‰´ ë‹¨ì¼ ì¡°íšŒ | GET | /stores/{storeId}/menu/{menuId} | none |

### 6. Order API
| Name | Method | URL | Auth |
|---|---|---|---|
| ì£¼ë¬¸ ìƒì„± | POST | /orders | user |
| ì£¼ë¬¸ ì·¨ì†Œ | PATCH | /orders/{orderId}/cancel | user |

### 7. Cart API
| Name | Method | URL | Auth |
|---|---|---|---|
| ì¥ë°”êµ¬ë‹ˆ ìƒì„± | POST | /carts | user |
| ì¥ë°”êµ¬ë‹ˆ ìˆ˜ì • | PATCH | /carts/{cartId} | user |
| ì¥ë°”êµ¬ë‹ˆ ì‚­ì œ | DELETE | /carts/{cartId} | user |
| ì¥ë°”êµ¬ë‹ˆ ì¡°íšŒ | GET | /carts | user |

### 8. Review API
| Name | Method | URL | Auth |
|---|---|---|---|
| ë¦¬ë·° ì‘ì„± | POST | /orders/{orderId}/review | user |
| ë¦¬ë·° ìˆ˜ì • | PATCH | /reviews/{reviewId} | user |
| ë¦¬ë·° ì‚­ì œ | DELETE | /reviews/{reviewId} | user |
| ìœ ì € ë¦¬ë·° ë‹¨ì¼ ì¡°íšŒ | GET | /users/{userId}/reviews/{reviewId} | none |
| ìœ ì € ë¦¬ë·° ì „ì²´ ì¡°íšŒ | GET | /users/{userId}/reviews | none |
| ê°€ê²Œ ë¦¬ë·° ë‹¨ì¼ ì¡°íšŒ | GET | /stores/{storeId}/reviews/{reviewId} | none |
| ê°€ê²Œ ë¦¬ë·° ì „ì²´ ì¡°íšŒ | GET | /stores/{storeId}/reviews | none |

## ğŸŸ Technical Decision
### 1. S3 ê¸°ìˆ  ë„ì…
- ë©”ë‰´, ê°€ê²Œ ì´ë¯¸ì§€ ê´€ë¦¬
- ê°ì²´ ìŠ¤í† ë¦¬ì§€ ì„œë¹„ìŠ¤ ì‚¬ìš©
- S3ë¥¼ í†µí•œ ì €ì¥, ì‚­ì œ, ì¡°íšŒ

### 2. isDeleted ì‚¬ìš©
- ì‚­ì œëœ ë°ì´í„° ê´€ë¦¬ ìµœì í™”
- Boolean ê°’ â€˜isDeleted'

### 3. Redis DB ì‚¬ìš©
- ë¡œê·¸ì•„ì›ƒ êµ¬í˜„
- ë¹ ë¥¸ ë°ì´í„° ì ‘ê·¼
- Statefulí•˜ë‚˜ Statelessì ì¸ ì†ë„ë¥¼ ìœ„í•´ ì‚¬ìš©

## ğŸŸ Trouble Shooting
### 1. Not possible to fast-forward, aborting ì—ëŸ¬
- **ì›ì¸ ì¶”ë¡ **
  - ```git config pull.ff only```Â ë¥¼ í†µí•´ pullì˜ ê¸°ë³¸ ì˜µì…˜ì„ ff-onlyë¡œ ì„¤ì •í•´ë†“ì€ ê²½ìš° ë°œìƒí•  ìˆ˜ ìˆëŠ” ì—ëŸ¬
  - pull í•˜ë ¤ëŠ” ì›ê²©ì €ì¥ì†Œì˜ ë¸Œëœì¹˜ì™€ ë¡œì»¬ì €ì¥ì†Œì˜ ë¸Œëœì¹˜ê°€ Fast-Forward ê´€ê³„ê°€ ì•„ë‹ë•Œ ë°œìƒ -> ì¦‰,ì›ê²©ì €ì¥ì†Œì˜ ìƒˆë¡œìš´ commitì´ ì¡´ì¬í•˜ëŠ”ë° git pullì„ í•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ë¡œì»¬ì €ì¥ì†Œì— ìƒˆë¡œìš´ commitì„ í–ˆë‹¤ë©´ í•´ë‹¹ ì—ëŸ¬ê°€ ë°œìƒ
- **í•´ê²° ë°©ì•ˆ**
  - ê·¼ë³¸ì ì¸ í•´ê²°
    - ê·¼ë³¸ì ìœ¼ë¡œ í•´ê²°í•˜ë ¤ë©´ fast-forward only ì˜µì…˜ì„ ```git config --unset pull.ff```
- **ì°¸ê³  ìë£Œ**
  - [Not possible to fast-forward, aborting.](https://velog.io/@eunddodi/Not-possible-to-fast-forward-aborting.-%EC%97%90%EB%9F%AC-%ED%95%B4%EA%B2%B0)

### 2. getWriter() has already been called for this response ì—ëŸ¬
- **ë¬¸ì œ ì •ì˜**
  - ìœ ì € íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸ ì¤‘ getWriter() has already been called for this response ì¶œë ¥
  - ExceptionHandelerì—ì„œ ë¬¸ì œê°€ ë‚¬ë‹¤ê³  í•˜ê¸¸ë˜, Exceptionì„ ì•ˆ ë‚´ë©´ ë˜ê² ë‹¤ ìƒê°
    ![image](https://github.com/palpalTeam/Palpal-Eats/assets/82515938/5311c4e3-3355-46ec-893d-fc550b6a7155)

  - Exceptionì„ ì•ˆ ë‚´ë„ getWriter ì˜¤ë¥˜ ë°œìƒ
    ![image](https://github.com/palpalTeam/Palpal-Eats/assets/82515938/073052ca-d450-463f-a2db-1c5ffbbf4c5d)

- **ì›ì¸ ì¶”ë¡ **
  - responseë¥¼ ë°˜í™˜í•´ì•¼í•˜ëŠ”ë°, ì´ë¯¸ getWriter()ê°€ ì“°ì˜€ê¸° ë•Œë¬¸ì— ì•ˆ ëœë‹¤ëŠ” ì˜ë¯¸ ê°™ì€ë°, JwtAuthorizationFilterì—ì„œ ì˜¤ë¥˜ê°€ ë‚œë‹¤ê³  í•œë‹¤.
    ![image](https://github.com/palpalTeam/Palpal-Eats/assets/82515938/22b4055f-9ed8-4137-9ef8-2dc82f6f43ce)

  - ì´ ë¶€ë¶„ì—ì„œ ë‚œë‹¤.
    ![image](https://github.com/palpalTeam/Palpal-Eats/assets/82515938/c3ee1429-eb71-4dc2-a9f6-cba12d5e328b)

  - ì‘ì„±í•œ ì½”ë“œë¥¼ ë³´ë©´ í† í°ì´ ìœ íš¨í•˜ì§€ ì•Šì„ ì‹œ getWriter()ë¥¼ ì“°ëŠ”ë°, ìƒê°í•´ë³´ë‹ˆ ì™œ íšŒì›ê°€ì…ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ”ë° Authorizationì— ë“¤ì–´ê°€ì§€?
    
- **í•´ê²° ë°©ì•ˆ**
  - AuthorizationFilterì—ì„œ Responseë§Œë“¤ê³  writerë¥¼ í•˜ëŠ”ê²Œ ì¼ë°˜ì ì¸ ë°©ë²•ì´ ì•„ë‹ˆë‹¤.
  - ê·¸ë˜ì„œ í•„í„°ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ Filter ì•ë‹¨ì— Exception Handlerë¥¼ ì¶”ê°€í•´ì„œ ë¬¸ì œë¥¼ í•´ê²°í–ˆë‹¤.

- **ì°¸ê³  ìë£Œ**
  - [Spring Security - ê¸°ë³¸ API ë° Filter ì´í•´](https://gong-story.tistory.com/34)
  - [Spring Security - Filter ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ í•¸ë“¤ë§í•˜ê¸°](https://jhkimmm.tistory.com/29)

### 3. API pathì—ì„œ Id ê°’ì„ ëª» ì°¾ëŠ” ì—ëŸ¬
- **ë¬¸ì œ ì •ì˜**
  - Postmanìœ¼ë¡œ ë¦¬ë·° ìƒì„± í…ŒìŠ¤íŠ¸ ì¤‘ì— ì‘ì„±ìë¥¼ ë°›ì•„ì˜¤ëŠ” orderIdê°’ì„ ë°›ì•„ì˜¤ì§€ ëª»í•˜ëŠ” ìƒí™©ì´ ë°œìƒ
  ![image](https://github.com/palpalTeam/Palpal-Eats/assets/82515938/28b07f0d-073d-446c-91c9-93463320acf0)
  
  - ì½”ë“œ ìƒìœ¼ë¡œëŠ” @PathVariableì„ ì´ìš©í•˜ì—¬ Long orderId ê°’ì„ ë°›ì•„ ì˜¤ë„ë¡ ì‘ì„±í–ˆìœ¼ë‚˜ ì›ì¸ì´ ë¬´ì—‡ë•Œë¬¸ì¸ì§€ Longê°’ì„ ë°›ì•„ì˜¤ì§€ ëª»í•¨
  ![image](https://github.com/palpalTeam/Palpal-Eats/assets/82515938/710c366d-219c-4a57-a54d-e212e756cea1)

- **ì›ì¸ ì¶”ë¡ **
  - ì˜¤ë¥˜ ë¶€ë¶„ìƒ Userì˜ ì •ë³´ëŠ” ë°›ì•„ì˜¤ëŠ”ê²ƒ ê°™ì§€ë§Œ ë¦¬ë·° ì‘ì„± êµ¬ì¡°ëŠ” Userê°€ ì¥ë°”êµ¬ë‹ˆì— ë©”ë‰´ë¥¼ ë‹´ì•„ ì£¼ë¬¸ì„ í–ˆì„ê²½ìš° ì‘ì„±í•¨ìœ¼ë¡œ ì£¼ë¬¸ìª½ì¸ orderIdì˜ ê°’ì„ ë°›ì•„ ì˜¤ì§€ëª»í•˜ëŠ”ê²ƒìœ¼ë¡œ ì¶”ì •ë¨

- **í•´ê²° ë°©ì•ˆ**
  - urlì— ì„¤ì •í•´ë‘” ê°’ì„ PathVariableë¡œ ë°›ì•„ì˜¬ì‹œ ë°‘ì— ì˜ˆì œì²˜ëŸ¼ String idì™€ ê°™ì´ ì´ë¦„ì´ ê°™ë‹¤ë©´ (â€idâ€) ë¶€ë¶„ì´ ìƒëµì´ ê°€ëŠ¥í•˜ë‹¤
    ```java
    @RestController
    public class MemberContoller{
    	@GetMapping("/test/url/{id}")
    	public String findById(@PathVariable("id") String id) {
    		retrun "Id: " + id;
    	}
    }
    ```
  - í•˜ì§€ë§Œ URI ì— ìˆëŠ” íŠ¹ì •ê°’ì„ ì§€ì •í•˜ì—¬ ë³€ìˆ˜ë¡œ ì§€ì •í•˜ê³  ì‹¶ë‹¤ë©´ ìœ„ ì½”ë“œì™€ ê°™ì´ @PathVariableë’¤ì— ( ) ë¥¼ ë„£ì–´ urlì˜ ë³€ìˆ˜ëª…ì„ ë„£ì€í›„ ë’¤ì— ì˜¤ëŠ” ë³€ìˆ˜ëª…ì˜ íƒ€ì…, ê°’ì„ ë„£ì–´ì•¼í•œë‹¤.
  - @PathVariable ë’¤ì— (â€orderIdâ€) ë¥¼ ë„£ìŒìœ¼ë¡œì„œ ë°›ì•„ì•¼í•  ê°’ì„ ë°›ë„ë¡ ë„£ìŒìœ¼ë¡œì„œ í•´ê²°í–ˆë‹¤.
    ![image](https://github.com/palpalTeam/Palpal-Eats/assets/82515938/72fb32a0-c258-4d8c-9f24-e909a4cb2fe8)

- **ì°¸ê³  ìë£Œ**
  - [Spring - ì‚¬ìš©ìê°€ ì „ë‹¬í•œ ê°’ ì‚¬ìš©í•˜ê¸°](https://galid1.tistory.com/505)
